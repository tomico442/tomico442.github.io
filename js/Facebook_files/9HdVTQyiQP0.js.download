if (self.CavalryLogger) { CavalryLogger.start_js_script(document.currentScript); }

__d("LSUpdateThreadSnippet",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1];b.n;var c=[],d=[],e;return b.seq([function(d){return a[7]?b.seq([function(d){return b.i64.neq(a[3],e)?b.seq([function(d){return b.seq([function(d){return b.ftr(b.db.table(14).fetch([[[a[0],a[3]]]]),function(c){return b.i64.eq(c.threadKey,a[0])&&b.i64.eq([0,0],[0,0])&&b.i64.eq(c.contactId,a[3])}).next().then(function(a,b){var d=a.done;a=a.value;return d?c[3]=e:(b=a.item,c[3]=b.nickname)})},function(d){return b.ftr(b.db.table(7).fetch([[[a[3]]]]),function(c){return b.i64.eq(c.id,a[3])&&b.i64.eq([0,1],[0,1])}).next().then(function(a,d){var f=a.done;a=a.value;return f?(c[7]=b.localizeV2([0,14617150],e),c[5]=c[7]):(d=a.item,c[5]=d.firstName==null?d.name:d.firstName)})},function(a){return c[1]=c[3]==null?c[5]:c[3]}])},function(b){return a[1]!==e?c[2]=[c[1],": ",a[1]].join(""):c[2]=e,c[0]=c[2]}]):b.resolve(c[0]=a[1])},function(d){return b.fe(b.db.table(9).fetch([[[a[0]]]]),function(b){var d=b.update;b.item;return d({snippet:c[0],snippetStringHash:e,snippetStringArgument1:e,snippetAttribution:e,snippetAttributionStringHash:e,isAdminSnippet:a[2],snippetSenderContactId:a[3],snippetHasEmoji:a[4],viewedPluginKey:a[5],viewedPluginContext:a[6]})})}]):b.fe(b.db.table(9).fetch([[[a[0]]]]),function(b){var c=b.update;b.item;return c({snippet:a[1],snippetStringHash:e,snippetStringArgument1:e,snippetAttribution:e,snippetAttributionStringHash:e,isAdminSnippet:a[2],snippetSenderContactId:a[3],snippetHasEmoji:a[4],viewedPluginKey:a[5],viewedPluginContext:a[6]})})},function(a){return b.resolve(d)}])}e.exports=a}),null);