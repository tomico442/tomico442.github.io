if (self.CavalryLogger) { CavalryLogger.start_js_script(document.currentScript); }

__d("LSDeleteThenInsertMessage",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1];b.n;var c=[];return b.seq([function(c){return b.db.table(12).fetch([[[a[9]]],"optimistic"]).next().then(function(c,d){var e=c.done;c=c.value;return e?b.db.table(12).add({threadKey:a[3],timestampMs:a[5],messageId:a[8],offlineThreadingId:a[9],authorityLevel:a[2],primarySortKey:a[6],senderId:a[10],isAdminMessage:a[12],sendStatus:a[14],sendStatusV2:a[15],text:a[0],subscriptErrorMessage:a[1],secondarySortKey:a[7],stickerId:a[11],isUnsent:a[16],unsentTimestampMs:a[17],mentionOffsets:a[18],mentionLengths:a[19],mentionIds:a[20],mentionTypes:a[21],replySourceId:a[22],replySourceType:a[23],replySourceTypeV2:a[24],replyStatus:a[25],replySnippet:a[26],replyMessageText:a[27],replyToUserId:a[28],replyMediaExpirationTimestampMs:a[29],replyMediaUrl:a[30],replyMediaPreviewWidth:a[32],replyMediaPreviewHeight:a[33],replyMediaUrlMimeType:a[34],replyMediaUrlFallback:a[35],replyCtaId:a[36],replyCtaTitle:a[37],replyAttachmentType:a[38],replyAttachmentId:a[39],replyAttachmentExtra:a[40],forwardScore:a[41],hasQuickReplies:a[42],adminMsgCtaId:a[43],adminMsgCtaTitle:a[44],adminMsgCtaType:a[45],cannotUnsendReason:a[46],textHasLinks:a[47],viewFlags:a[48],displayedContentTypes:a[49],viewedPluginKey:a[50],viewedPluginContext:a[51],quickReplyType:a[52],hotEmojiSize:a[53],replySourceTimestampMs:a[54],ephemeralDurationInSec:a[55],msUntilExpirationTs:a[56],ephemeralExpirationTs:a[57]}):(d=c.item,b.i64.le(d.authorityLevel,a[2])?b.db.table(12).put({threadKey:a[3],timestampMs:a[5],messageId:a[8],offlineThreadingId:a[9],authorityLevel:a[2],primarySortKey:d.primarySortKey,senderId:a[10],isAdminMessage:a[12],sendStatus:a[14],sendStatusV2:a[15],text:a[0],subscriptErrorMessage:a[1],secondarySortKey:d.secondarySortKey,stickerId:a[11],isUnsent:a[16],unsentTimestampMs:a[17],mentionOffsets:a[18],mentionLengths:a[19],mentionIds:a[20],mentionTypes:a[21],replySourceId:a[22],replySourceType:a[23],replySourceTypeV2:a[24],replyStatus:a[25],replySnippet:a[26],replyMessageText:a[27],replyToUserId:a[28],replyMediaExpirationTimestampMs:a[29],replyMediaUrl:a[30],replyMediaPreviewWidth:a[32],replyMediaPreviewHeight:a[33],replyMediaUrlMimeType:a[34],replyMediaUrlFallback:a[35],replyCtaId:a[36],replyCtaTitle:a[37],replyAttachmentType:a[38],replyAttachmentId:a[39],replyAttachmentExtra:a[40],forwardScore:a[41],hasQuickReplies:a[42],adminMsgCtaId:a[43],adminMsgCtaTitle:a[44],adminMsgCtaType:a[45],cannotUnsendReason:a[46],textHasLinks:a[47],viewFlags:a[48],displayedContentTypes:a[49],viewedPluginKey:a[50],viewedPluginContext:a[51],quickReplyType:a[52],hotEmojiSize:a[53],replySourceTimestampMs:a[54],ephemeralDurationInSec:a[55],msUntilExpirationTs:a[56],ephemeralExpirationTs:a[57]}):b.resolve())})},function(a){return b.resolve(c)}])}e.exports=a}),null);