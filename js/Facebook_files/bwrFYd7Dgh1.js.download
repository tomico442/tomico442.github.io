if (self.CavalryLogger) { CavalryLogger.start_js_script(document.currentScript); }

__d("LSUpdateThreadSnippetFromLastMessageV2",["LSGetViewerFBID","LSUpdateThreadSnippet"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1];c.n;var d=[],e=[],f;return c.seq([function(e){return c.db.table(12).fetchDesc([[[a[0]]]]).next().then(function(e,g){var h=e.done;e=e.value;return h?0:(g=e.item,c.seq([function(a){return d[5]=g.text,d[4]=g.threadKey,d[7]=[0,0],d[8]=g.messageId,d[3]=g.senderId,d[6]=g.stickerId,d[2]=g.isAdminMessage,d[0]=!0,d[2]||!d[0]?c.resolve(d[1]=d[5]==null?"":d[5]):c.seq([function(a){return g.isUnsent?c.seq([function(a){return c.sp(b("LSGetViewerFBID")).then(function(a){return a=a,d[10]=a[0],a})},function(a){return c.i64.eq(d[10],d[3])?c.resolve((d[15]=c.localizeV2([0,2375715979],f),d[11]=d[15])):c.seq([function(a){return c.seq([function(a){return c.ftr(c.db.table(14).fetch([[[d[4],d[3]]]]),function(a){return c.i64.eq(a.threadKey,d[4])&&c.i64.eq([0,0],[0,0])&&c.i64.eq(a.contactId,d[3])}).next().then(function(b,c){var a=b.done;b=b.value;return a?d[18]=f:(c=b.item,d[18]=c.nickname)})},function(a){return c.ftr(c.db.table(7).fetch([[[d[3]]]]),function(a){return c.i64.eq(a.id,d[3])&&c.i64.eq([0,1],[0,1])}).next().then(function(b,e){var a=b.done;b=b.value;return a?(d[22]=c.localizeV2([0,14617150],f),d[20]=d[22]):(e=b.item,d[20]=e.firstName==null?e.name:e.firstName)})},function(a){return d[15]=d[18]==null?d[20]:d[18]}])},function(a){return d[16]=c.createArray(),d[18]=(d[16].push(d[15]),d[16]),d[17]=c.localizeV2([0,3810165735],d[16]),d[11]=d[17]}])},function(a){return c.db.table(9).fetch([[[d[4]]]]).next().then(function(b,e){var a=b.done;b=b.value;return a?d[12]=!1:(e=b.item,d[12]=c.i64.eq(e.threadType,[0,18]))})},function(a){return d[12]?c.seq([function(a){return c.ftr(c.db.table(16).fetch([[[d[4],d[8]]]]),function(a){return c.i64.eq(a.threadKey,d[4])&&c.i64.eq([0,0],d[7])&&a.messageId===d[8]}).next().then(function(b,c){var a=b.done;b=b.value;return a?(a=[[0,0],f,f,f],d[15]=a[0],d[16]=a[1],d[17]=a[2],d[18]=a[3],a):(c=b.item,a=[c.attachmentType,c.attributionAppName,c.defaultCtaType,c.descriptionText],d[15]=a[0],d[16]=a[1],d[17]=a[2],d[18]=a[3],a)})},function(a){return d[18]!==f?d[20]=d[18]:d[20]=d[11],d[14]=d[20]}]):c.resolve(d[14]=d[11])},function(a){return d[9]=d[14]}]):c.seq([function(a){return d[5]!==f&&d[5]!==""?c.seq([function(a){return d[13]=d[5]==null?"":d[5],c.sp(b("LSGetViewerFBID")).then(function(a){return a=a,d[11]=a[0],a})},function(a){return c.i64.eq(d[11],d[3])?c.resolve((d[14]=c.localizeV2([0,1890485478],f),d[12]=[d[14],": ",d[13]].join(""))):c.seq([function(a){return c.db.table(9).fetch([[[d[4]]]]).next().then(function(b,e){var a=b.done;b=b.value;return a?d[14]=!1:(e=b.item,d[14]=c.i64.eq(e.threadType,[0,2]))})},function(a){return d[14]?c.seq([function(a){return c.seq([function(a){return c.ftr(c.db.table(14).fetch([[[d[4],d[3]]]]),function(a){return c.i64.eq(a.threadKey,d[4])&&c.i64.eq([0,0],[0,0])&&c.i64.eq(a.contactId,d[3])}).next().then(function(b,c){var a=b.done;b=b.value;return a?d[18]=f:(c=b.item,d[18]=c.nickname)})},function(a){return c.ftr(c.db.table(7).fetch([[[d[3]]]]),function(a){return c.i64.eq(a.id,d[3])&&c.i64.eq([0,1],[0,1])}).next().then(function(b,e){var a=b.done;b=b.value;return a?(d[22]=c.localizeV2([0,14617150],f),d[20]=d[22]):(e=b.item,d[20]=e.firstName==null?e.name:e.firstName)})},function(a){return d[17]=d[18]==null?d[20]:d[18]}])},function(a){return d[16]=[d[17],": ",d[13]].join("")}]):c.resolve(d[16]=d[13])},function(a){return d[12]=d[16]}])},function(a){return d[10]=d[12]}]):c.seq([function(a){return c.i64.neq(d[6],f)&&[[53057,267535043],[85970,924785702],[85970,1004785694],[85970,1044785690]].some(function(a){return c.i64.eq(d[6],a)})?c.seq([function(a){return d[14]="\udb80\udc00",c.sp(b("LSGetViewerFBID")).then(function(a){return a=a,d[12]=a[0],a})},function(a){return c.i64.eq(d[12],d[3])?c.resolve((d[15]=c.localizeV2([0,1890485478],f),d[13]=[d[15],": ",d[14]].join(""))):c.seq([function(a){return c.db.table(9).fetch([[[d[4]]]]).next().then(function(b,e){var a=b.done;b=b.value;return a?d[15]=!1:(e=b.item,d[15]=c.i64.eq(e.threadType,[0,2]))})},function(a){return d[15]?c.seq([function(a){return c.seq([function(a){return c.ftr(c.db.table(14).fetch([[[d[4],d[3]]]]),function(a){return c.i64.eq(a.threadKey,d[4])&&c.i64.eq([0,0],[0,0])&&c.i64.eq(a.contactId,d[3])}).next().then(function(b,c){var a=b.done;b=b.value;return a?d[19]=f:(c=b.item,d[19]=c.nickname)})},function(a){return c.ftr(c.db.table(7).fetch([[[d[3]]]]),function(a){return c.i64.eq(a.id,d[3])&&c.i64.eq([0,1],[0,1])}).next().then(function(b,e){var a=b.done;b=b.value;return a?(d[23]=c.localizeV2([0,14617150],f),d[21]=d[23]):(e=b.item,d[21]=e.firstName==null?e.name:e.firstName)})},function(a){return d[18]=d[19]==null?d[21]:d[19]}])},function(a){return d[17]=[d[18],": ",d[14]].join("")}]):c.resolve(d[17]=d[14])},function(a){return d[13]=d[17]}])},function(a){return d[11]=d[13]}]):c.seq([function(a){return c.i64.neq(d[6],f)?c.seq([function(a){return c.sp(b("LSGetViewerFBID")).then(function(a){return a=a,d[13]=a[0],a})},function(a){return c.i64.eq(d[13],d[3])?c.resolve((d[15]=c.localizeV2([0,1299547062],f),d[14]=d[15])):c.seq([function(a){return c.seq([function(a){return c.ftr(c.db.table(14).fetch([[[d[4],d[3]]]]),function(a){return c.i64.eq(a.threadKey,d[4])&&c.i64.eq([0,0],[0,0])&&c.i64.eq(a.contactId,d[3])}).next().then(function(b,c){var a=b.done;b=b.value;return a?d[18]=f:(c=b.item,d[18]=c.nickname)})},function(a){return c.ftr(c.db.table(7).fetch([[[d[3]]]]),function(a){return c.i64.eq(a.id,d[3])&&c.i64.eq([0,1],[0,1])}).next().then(function(b,e){var a=b.done;b=b.value;return a?(d[22]=c.localizeV2([0,14617150],f),d[20]=d[22]):(e=b.item,d[20]=e.firstName==null?e.name:e.firstName)})},function(a){return d[15]=d[18]==null?d[20]:d[18]}])},function(a){return d[16]=c.createArray(),d[18]=(d[16].push(d[15]),d[16]),d[17]=c.localizeV2([0,3621454483],d[16]),d[14]=d[17]}])},function(a){return d[12]=d[14]}]):c.seq([function(a){return c.ct(c.ftr(c.db.table(16).fetch([[[d[4],d[8]]]]),function(a){return c.i64.eq(a.threadKey,d[4])&&c.i64.eq([0,0],d[7])&&a.messageId===d[8]})).then(function(a){return d[13]=a})},function(a){return c.i64.eq(d[13],[0,0])?c.seq([function(a){return c.sp(b("LSGetViewerFBID")).then(function(a){return a=a,d[15]=a[0],a})},function(a){return c.i64.eq(d[15],d[3])?c.resolve((d[17]=c.localizeV2([0,3948960063],f),d[16]=d[17])):c.seq([function(a){return c.seq([function(a){return c.ftr(c.db.table(14).fetch([[[d[4],d[3]]]]),function(a){return c.i64.eq(a.threadKey,d[4])&&c.i64.eq([0,0],[0,0])&&c.i64.eq(a.contactId,d[3])}).next().then(function(b,c){var a=b.done;b=b.value;return a?d[20]=f:(c=b.item,d[20]=c.nickname)})},function(a){return c.ftr(c.db.table(7).fetch([[[d[3]]]]),function(a){return c.i64.eq(a.id,d[3])&&c.i64.eq([0,1],[0,1])}).next().then(function(b,e){var a=b.done;b=b.value;return a?(d[24]=c.localizeV2([0,14617150],f),d[22]=d[24]):(e=b.item,d[22]=e.firstName==null?e.name:e.firstName)})},function(a){return d[17]=d[20]==null?d[22]:d[20]}])},function(a){return d[18]=c.createArray(),d[20]=(d[18].push(d[17]),d[18]),d[19]=c.localizeV2([0,1249692047],d[18]),d[16]=d[19]}])},function(a){return d[14]=d[16]}]):c.seq([function(a){return c.i64.eq(d[13],[0,1])?c.seq([function(a){return c.ftr(c.db.table(16).fetch([[[d[4],d[8]]]]),function(a){return c.i64.eq(a.threadKey,d[4])&&c.i64.eq([0,0],d[7])&&a.messageId===d[8]}).next().then(function(b,c){var a=b.done;b=b.value;return a?(a=[[0,0],f,f,f],d[16]=a[0],d[17]=a[1],d[18]=a[2],d[19]=a[3],a):(c=b.item,a=[c.attachmentType,c.attributionAppName,c.defaultCtaType,c.descriptionText],d[16]=a[0],d[17]=a[1],d[18]=a[2],d[19]=a[3],a)})},function(a){return d[21]=f,c.i64.eq(d[16],[0,1])?c.seq([function(a){return c.sp(b("LSGetViewerFBID")).then(function(a){return a=a,d[26]=a[0],a})},function(a){return c.i64.eq(d[26],d[3])?c.resolve((d[28]=c.localizeV2([0,1299547062],f),d[27]=d[28])):c.seq([function(a){return c.seq([function(a){return c.ftr(c.db.table(14).fetch([[[d[4],d[3]]]]),function(a){return c.i64.eq(a.threadKey,d[4])&&c.i64.eq([0,0],[0,0])&&c.i64.eq(a.contactId,d[3])}).next().then(function(b,c){var a=b.done;b=b.value;return a?d[31]=f:(c=b.item,d[31]=c.nickname)})},function(a){return c.ftr(c.db.table(7).fetch([[[d[3]]]]),function(a){return c.i64.eq(a.id,d[3])&&c.i64.eq([0,1],[0,1])}).next().then(function(b,e){var a=b.done;b=b.value;return a?(d[35]=c.localizeV2([0,14617150],f),d[33]=d[35]):(e=b.item,d[33]=e.firstName==null?e.name:e.firstName)})},function(a){return d[28]=d[31]==null?d[33]:d[31]}])},function(a){return d[29]=c.createArray(),d[31]=(d[29].push(d[28]),d[29]),d[30]=c.localizeV2([0,3621454483],d[29]),d[27]=d[30]}])},function(a){return d[21]=d[27]}]):c.resolve()},function(a){return d[21]===f&&(c.i64.eq(d[16],[0,2])||c.i64.eq(d[16],[0,8]))?c.seq([function(a){return c.sp(b("LSGetViewerFBID")).then(function(a){return a=a,d[26]=a[0],a})},function(a){return c.i64.eq(d[26],d[3])?c.resolve((d[28]=c.localizeV2([0,2106510577],f),d[27]=d[28])):c.seq([function(a){return c.seq([function(a){return c.ftr(c.db.table(14).fetch([[[d[4],d[3]]]]),function(a){return c.i64.eq(a.threadKey,d[4])&&c.i64.eq([0,0],[0,0])&&c.i64.eq(a.contactId,d[3])}).next().then(function(b,c){var a=b.done;b=b.value;return a?d[31]=f:(c=b.item,d[31]=c.nickname)})},function(a){return c.ftr(c.db.table(7).fetch([[[d[3]]]]),function(a){return c.i64.eq(a.id,d[3])&&c.i64.eq([0,1],[0,1])}).next().then(function(b,e){var a=b.done;b=b.value;return a?(d[35]=c.localizeV2([0,14617150],f),d[33]=d[35]):(e=b.item,d[33]=e.firstName==null?e.name:e.firstName)})},function(a){return d[28]=d[31]==null?d[33]:d[31]}])},function(a){return d[29]=c.createArray(),d[31]=(d[29].push(d[28]),d[29]),d[30]=c.localizeV2([0,3960370133],d[29]),d[27]=d[30]}])},function(a){return d[21]=d[27]}]):c.resolve()},function(a){return d[21]===f&&c.i64.eq(d[16],[0,3])?c.seq([function(a){return d[17]!==f?c.seq([function(a){return c.sp(b("LSGetViewerFBID")).then(function(a){return a=a,d[27]=a[0],a})},function(a){return c.i64.eq(d[27],d[3])?c.resolve((d[29]=c.createArray(),d[31]=(d[29].push(d[17]),d[29]),d[30]=c.localizeV2([0,3798396796],d[29]),d[28]=d[30])):c.seq([function(a){return c.seq([function(a){return c.ftr(c.db.table(14).fetch([[[d[4],d[3]]]]),function(a){return c.i64.eq(a.threadKey,d[4])&&c.i64.eq([0,0],[0,0])&&c.i64.eq(a.contactId,d[3])}).next().then(function(b,c){var a=b.done;b=b.value;return a?d[32]=f:(c=b.item,d[32]=c.nickname)})},function(a){return c.ftr(c.db.table(7).fetch([[[d[3]]]]),function(a){return c.i64.eq(a.id,d[3])&&c.i64.eq([0,1],[0,1])}).next().then(function(b,e){var a=b.done;b=b.value;return a?(d[36]=c.localizeV2([0,14617150],f),d[34]=d[36]):(e=b.item,d[34]=e.firstName==null?e.name:e.firstName)})},function(a){return d[29]=d[32]==null?d[34]:d[32]}])},function(a){return d[30]=c.createArray(),d[32]=(d[30].push(d[29]),d[30]),d[32]=(d[30].push(d[17]),d[30]),d[31]=c.localizeV2([0,3388601579],d[30]),d[28]=d[31]}])},function(a){return d[26]=d[28]}]):c.seq([function(a){return c.sp(b("LSGetViewerFBID")).then(function(a){return a=a,d[27]=a[0],a})},function(a){return c.i64.eq(d[27],d[3])?c.resolve((d[29]=c.localizeV2([0,1556712457],f),d[28]=d[29])):c.seq([function(a){return c.seq([function(a){return c.ftr(c.db.table(14).fetch([[[d[4],d[3]]]]),function(a){return c.i64.eq(a.threadKey,d[4])&&c.i64.eq([0,0],[0,0])&&c.i64.eq(a.contactId,d[3])}).next().then(function(b,c){var a=b.done;b=b.value;return a?d[32]=f:(c=b.item,d[32]=c.nickname)})},function(a){return c.ftr(c.db.table(7).fetch([[[d[3]]]]),function(a){return c.i64.eq(a.id,d[3])&&c.i64.eq([0,1],[0,1])}).next().then(function(b,e){var a=b.done;b=b.value;return a?(d[36]=c.localizeV2([0,14617150],f),d[34]=d[36]):(e=b.item,d[34]=e.firstName==null?e.name:e.firstName)})},function(a){return d[29]=d[32]==null?d[34]:d[32]}])},function(a){return d[30]=c.createArray(),d[32]=(d[30].push(d[29]),d[30]),d[31]=c.localizeV2([0,3601791933],d[30]),d[28]=d[31]}])},function(a){return d[26]=d[28]}])},function(a){return d[21]=d[26]}]):c.resolve()},function(a){return d[21]===f&&(c.i64.eq(d[16],[0,4])||c.i64.eq(d[16],[0,9]))?c.seq([function(a){return c.sp(b("LSGetViewerFBID")).then(function(a){return a=a,d[26]=a[0],a})},function(a){return c.i64.eq(d[26],d[3])?c.resolve((d[28]=c.localizeV2([0,3759817031],f),d[27]=d[28])):c.seq([function(a){return c.seq([function(a){return c.ftr(c.db.table(14).fetch([[[d[4],d[3]]]]),function(a){return c.i64.eq(a.threadKey,d[4])&&c.i64.eq([0,0],[0,0])&&c.i64.eq(a.contactId,d[3])}).next().then(function(b,c){var a=b.done;b=b.value;return a?d[31]=f:(c=b.item,d[31]=c.nickname)})},function(a){return c.ftr(c.db.table(7).fetch([[[d[3]]]]),function(a){return c.i64.eq(a.id,d[3])&&c.i64.eq([0,1],[0,1])}).next().then(function(b,e){var a=b.done;b=b.value;return a?(d[35]=c.localizeV2([0,14617150],f),d[33]=d[35]):(e=b.item,d[33]=e.firstName==null?e.name:e.firstName)})},function(a){return d[28]=d[31]==null?d[33]:d[31]}])},function(a){return d[29]=c.createArray(),d[31]=(d[29].push(d[28]),d[29]),d[30]=c.localizeV2([0,2934729541],d[29]),d[27]=d[30]}])},function(a){return d[21]=d[27]}]):c.resolve()},function(a){return d[21]===f&&c.i64.eq(d[16],[0,5])?c.seq([function(a){return c.sp(b("LSGetViewerFBID")).then(function(a){return a=a,d[26]=a[0],a})},function(a){return c.i64.eq(d[26],d[3])?c.resolve((d[28]=c.localizeV2([0,392493418],f),d[27]=d[28])):c.seq([function(a){return c.seq([function(a){return c.ftr(c.db.table(14).fetch([[[d[4],d[3]]]]),function(a){return c.i64.eq(a.threadKey,d[4])&&c.i64.eq([0,0],[0,0])&&c.i64.eq(a.contactId,d[3])}).next().then(function(b,c){var a=b.done;b=b.value;return a?d[31]=f:(c=b.item,d[31]=c.nickname)})},function(a){return c.ftr(c.db.table(7).fetch([[[d[3]]]]),function(a){return c.i64.eq(a.id,d[3])&&c.i64.eq([0,1],[0,1])}).next().then(function(b,e){var a=b.done;b=b.value;return a?(d[35]=c.localizeV2([0,14617150],f),d[33]=d[35]):(e=b.item,d[33]=e.firstName==null?e.name:e.firstName)})},function(a){return d[28]=d[31]==null?d[33]:d[31]}])},function(a){return d[29]=c.createArray(),d[31]=(d[29].push(d[28]),d[29]),d[30]=c.localizeV2([0,4085467454],d[29]),d[27]=d[30]}])},function(a){return d[21]=d[27]}]):c.resolve()},function(a){return d[21]===f&&c.i64.eq(d[16],[0,10])?c.seq([function(a){return c.sp(b("LSGetViewerFBID")).then(function(a){return a=a,d[26]=a[0],a})},function(a){return c.i64.eq(d[26],d[3])?c.resolve((d[28]=c.localizeV2([0,2738683656],f),d[27]=d[28])):c.seq([function(a){return c.seq([function(a){return c.ftr(c.db.table(14).fetch([[[d[4],d[3]]]]),function(a){return c.i64.eq(a.threadKey,d[4])&&c.i64.eq([0,0],[0,0])&&c.i64.eq(a.contactId,d[3])}).next().then(function(b,c){var a=b.done;b=b.value;return a?d[31]=f:(c=b.item,d[31]=c.nickname)})},function(a){return c.ftr(c.db.table(7).fetch([[[d[3]]]]),function(a){return c.i64.eq(a.id,d[3])&&c.i64.eq([0,1],[0,1])}).next().then(function(b,e){var a=b.done;b=b.value;return a?(d[35]=c.localizeV2([0,14617150],f),d[33]=d[35]):(e=b.item,d[33]=e.firstName==null?e.name:e.firstName)})},function(a){return d[28]=d[31]==null?d[33]:d[31]}])},function(a){return d[29]=c.createArray(),d[31]=(d[29].push(d[28]),d[29]),d[30]=c.localizeV2([0,2996525642],d[29]),d[27]=d[30]}])},function(a){return d[21]=d[27]}]):c.resolve()},function(a){return d[18]==="xma_live_location_sharing"?d[22]=[0,3e3]:d[22]=f,c.i64.neq(d[22],f)?c.seq([function(a){return c.i64.eq(d[22],[0,0])?c.seq([function(a){return c.sp(b("LSGetViewerFBID")).then(function(a){return a=a,d[27]=a[0],a})},function(a){return c.i64.eq(d[27],d[3])?c.resolve((d[29]=c.localizeV2([0,3948960063],f),d[28]=d[29])):c.seq([function(a){return c.seq([function(a){return c.ftr(c.db.table(14).fetch([[[d[4],d[3]]]]),function(a){return c.i64.eq(a.threadKey,d[4])&&c.i64.eq([0,0],[0,0])&&c.i64.eq(a.contactId,d[3])}).next().then(function(b,c){var a=b.done;b=b.value;return a?d[32]=f:(c=b.item,d[32]=c.nickname)})},function(a){return c.ftr(c.db.table(7).fetch([[[d[3]]]]),function(a){return c.i64.eq(a.id,d[3])&&c.i64.eq([0,1],[0,1])}).next().then(function(b,e){var a=b.done;b=b.value;return a?(d[36]=c.localizeV2([0,14617150],f),d[34]=d[36]):(e=b.item,d[34]=e.firstName==null?e.name:e.firstName)})},function(a){return d[29]=d[32]==null?d[34]:d[32]}])},function(a){return d[30]=c.createArray(),d[32]=(d[30].push(d[29]),d[30]),d[31]=c.localizeV2([0,1249692047],d[30]),d[28]=d[31]}])},function(a){return d[26]=d[28]}]):c.seq([function(a){return c.i64.eq(d[22],[0,1e3])?c.seq([function(a){return c.sp(b("LSGetViewerFBID")).then(function(a){return a=a,d[28]=a[0],a})},function(a){return c.i64.eq(d[28],d[3])?c.resolve((d[30]=c.localizeV2([0,2326868239],f),d[29]=d[30])):c.seq([function(a){return c.seq([function(a){return c.ftr(c.db.table(14).fetch([[[d[4],d[3]]]]),function(a){return c.i64.eq(a.threadKey,d[4])&&c.i64.eq([0,0],[0,0])&&c.i64.eq(a.contactId,d[3])}).next().then(function(b,c){var a=b.done;b=b.value;return a?d[33]=f:(c=b.item,d[33]=c.nickname)})},function(a){return c.ftr(c.db.table(7).fetch([[[d[3]]]]),function(a){return c.i64.eq(a.id,d[3])&&c.i64.eq([0,1],[0,1])}).next().then(function(b,e){var a=b.done;b=b.value;return a?(d[37]=c.localizeV2([0,14617150],f),d[35]=d[37]):(e=b.item,d[35]=e.firstName==null?e.name:e.firstName)})},function(a){return d[30]=d[33]==null?d[35]:d[33]}])},function(a){return d[31]=c.createArray(),d[33]=(d[31].push(d[30]),d[31]),d[32]=c.localizeV2([0,1001986796],d[31]),d[29]=d[32]}])},function(a){return d[27]=d[29]}]):c.seq([function(a){return c.i64.eq(d[22],[0,1001])?c.seq([function(a){return c.sp(b("LSGetViewerFBID")).then(function(a){return a=a,d[29]=a[0],a})},function(a){return c.i64.eq(d[29],d[3])?c.resolve((d[31]=c.localizeV2([0,2326868239],f),d[30]=d[31])):c.seq([function(a){return c.seq([function(a){return c.ftr(c.db.table(14).fetch([[[d[4],d[3]]]]),function(a){return c.i64.eq(a.threadKey,d[4])&&c.i64.eq([0,0],[0,0])&&c.i64.eq(a.contactId,d[3])}).next().then(function(b,c){var a=b.done;b=b.value;return a?d[34]=f:(c=b.item,d[34]=c.nickname)})},function(a){return c.ftr(c.db.table(7).fetch([[[d[3]]]]),function(a){return c.i64.eq(a.id,d[3])&&c.i64.eq([0,1],[0,1])}).next().then(function(b,e){var a=b.done;b=b.value;return a?(d[38]=c.localizeV2([0,14617150],f),d[36]=d[38]):(e=b.item,d[36]=e.firstName==null?e.name:e.firstName)})},function(a){return d[31]=d[34]==null?d[36]:d[34]}])},function(a){return d[32]=c.createArray(),d[34]=(d[32].push(d[31]),d[32]),d[33]=c.localizeV2([0,1001986796],d[32]),d[30]=d[33]}])},function(a){return d[28]=d[30]}]):c.seq([function(a){return c.i64.eq(d[22],[0,1002])?c.seq([function(a){return c.sp(b("LSGetViewerFBID")).then(function(a){return a=a,d[30]=a[0],a})},function(a){return c.i64.eq(d[30],d[3])?c.resolve((d[32]=c.localizeV2([0,2285746939],f),d[31]=d[32])):c.seq([function(a){return c.seq([function(a){return c.ftr(c.db.table(14).fetch([[[d[4],d[3]]]]),function(a){return c.i64.eq(a.threadKey,d[4])&&c.i64.eq([0,0],[0,0])&&c.i64.eq(a.contactId,d[3])}).next().then(function(b,c){var a=b.done;b=b.value;return a?d[35]=f:(c=b.item,d[35]=c.nickname)})},function(a){return c.ftr(c.db.table(7).fetch([[[d[3]]]]),function(a){return c.i64.eq(a.id,d[3])&&c.i64.eq([0,1],[0,1])}).next().then(function(b,e){var a=b.done;b=b.value;return a?(d[39]=c.localizeV2([0,14617150],f),d[37]=d[39]):(e=b.item,d[37]=e.firstName==null?e.name:e.firstName)})},function(a){return d[32]=d[35]==null?d[37]:d[35]}])},function(a){return d[33]=c.createArray(),d[35]=(d[33].push(d[32]),d[33]),d[34]=c.localizeV2([0,3759448420],d[33]),d[31]=d[34]}])},function(a){return d[29]=d[31]}]):c.seq([function(a){return c.i64.eq(d[22],[0,1003])?c.seq([function(a){return c.sp(b("LSGetViewerFBID")).then(function(a){return a=a,d[31]=a[0],a})},function(a){return c.i64.eq(d[31],d[3])?c.resolve((d[33]=c.localizeV2([0,3719716921],f),d[32]=d[33])):c.seq([function(a){return c.seq([function(a){return c.ftr(c.db.table(14).fetch([[[d[4],d[3]]]]),function(a){return c.i64.eq(a.threadKey,d[4])&&c.i64.eq([0,0],[0,0])&&c.i64.eq(a.contactId,d[3])}).next().then(function(b,c){var a=b.done;b=b.value;return a?d[36]=f:(c=b.item,d[36]=c.nickname)})},function(a){return c.ftr(c.db.table(7).fetch([[[d[3]]]]),function(a){return c.i64.eq(a.id,d[3])&&c.i64.eq([0,1],[0,1])}).next().then(function(b,e){var a=b.done;b=b.value;return a?(d[40]=c.localizeV2([0,14617150],f),d[38]=d[40]):(e=b.item,d[38]=e.firstName==null?e.name:e.firstName)})},function(a){return d[33]=d[36]==null?d[38]:d[36]}])},function(a){return d[34]=c.createArray(),d[36]=(d[34].push(d[33]),d[34]),d[35]=c.localizeV2([0,284944921],d[34]),d[32]=d[35]}])},function(a){return d[30]=d[32]}]):c.seq([function(a){return c.i64.eq(d[22],[0,1004])?c.seq([function(a){return c.sp(b("LSGetViewerFBID")).then(function(a){return a=a,d[32]=a[0],a})},function(a){return c.i64.eq(d[32],d[3])?c.resolve((d[34]=c.localizeV2([0,3948960063],f),d[33]=d[34])):c.seq([function(a){return c.seq([function(a){return c.ftr(c.db.table(14).fetch([[[d[4],d[3]]]]),function(a){return c.i64.eq(a.threadKey,d[4])&&c.i64.eq([0,0],[0,0])&&c.i64.eq(a.contactId,d[3])}).next().then(function(b,c){var a=b.done;b=b.value;return a?d[37]=f:(c=b.item,d[37]=c.nickname)})},function(a){return c.ftr(c.db.table(7).fetch([[[d[3]]]]),function(a){return c.i64.eq(a.id,d[3])&&c.i64.eq([0,1],[0,1])}).next().then(function(b,e){var a=b.done;b=b.value;return a?(d[41]=c.localizeV2([0,14617150],f),d[39]=d[41]):(e=b.item,d[39]=e.firstName==null?e.name:e.firstName)})},function(a){return d[34]=d[37]==null?d[39]:d[37]}])},function(a){return d[35]=c.createArray(),d[37]=(d[35].push(d[34]),d[35]),d[36]=c.localizeV2([0,1249692047],d[35]),d[33]=d[36]}])},function(a){return d[31]=d[33]}]):c.seq([function(a){return c.i64.eq(d[22],[0,1005])?c.seq([function(a){return c.sp(b("LSGetViewerFBID")).then(function(a){return a=a,d[33]=a[0],a})},function(a){return c.i64.eq(d[33],d[3])?c.resolve((d[35]=c.localizeV2([0,3557790945],f),d[34]=d[35])):c.seq([function(a){return c.seq([function(a){return c.ftr(c.db.table(14).fetch([[[d[4],d[3]]]]),function(a){return c.i64.eq(a.threadKey,d[4])&&c.i64.eq([0,0],[0,0])&&c.i64.eq(a.contactId,d[3])}).next().then(function(b,c){var a=b.done;b=b.value;return a?d[38]=f:(c=b.item,d[38]=c.nickname)})},function(a){return c.ftr(c.db.table(7).fetch([[[d[3]]]]),function(a){return c.i64.eq(a.id,d[3])&&c.i64.eq([0,1],[0,1])}).next().then(function(b,e){var a=b.done;b=b.value;return a?(d[42]=c.localizeV2([0,14617150],f),d[40]=d[42]):(e=b.item,d[40]=e.firstName==null?e.name:e.firstName)})},function(a){return d[35]=d[38]==null?d[40]:d[38]}])},function(a){return d[36]=c.createArray(),d[38]=(d[36].push(d[35]),d[36]),d[37]=c.localizeV2([0,3756846086],d[36]),d[34]=d[37]}])},function(a){return d[32]=d[34]}]):c.seq([function(a){return c.i64.eq(d[22],[0,1006])?c.seq([function(a){return c.sp(b("LSGetViewerFBID")).then(function(a){return a=a,d[34]=a[0],a})},function(a){return c.i64.eq(d[34],d[3])?c.resolve((d[36]=c.localizeV2([0,2326868239],f),d[35]=d[36])):c.seq([function(a){return c.seq([function(a){return c.ftr(c.db.table(14).fetch([[[d[4],d[3]]]]),function(a){return c.i64.eq(a.threadKey,d[4])&&c.i64.eq([0,0],[0,0])&&c.i64.eq(a.contactId,d[3])}).next().then(function(b,c){var a=b.done;b=b.value;return a?d[39]=f:(c=b.item,d[39]=c.nickname)})},function(a){return c.ftr(c.db.table(7).fetch([[[d[3]]]]),function(a){return c.i64.eq(a.id,d[3])&&c.i64.eq([0,1],[0,1])}).next().then(function(b,e){var a=b.done;b=b.value;return a?(d[43]=c.localizeV2([0,14617150],f),d[41]=d[43]):(e=b.item,d[41]=e.firstName==null?e.name:e.firstName)})},function(a){return d[36]=d[39]==null?d[41]:d[39]}])},function(a){return d[37]=c.createArray(),d[39]=(d[37].push(d[36]),d[37]),d[38]=c.localizeV2([0,1001986796],d[37]),d[35]=d[38]}])},function(a){return d[33]=d[35]}]):c.seq([function(a){return c.i64.eq(d[22],[0,1007])?c.seq([function(a){return c.sp(b("LSGetViewerFBID")).then(function(a){return a=a,d[35]=a[0],a})},function(a){return c.i64.eq(d[35],d[3])?c.resolve((d[37]=c.localizeV2([0,3719716921],f),d[36]=d[37])):c.seq([function(a){return c.seq([function(a){return c.ftr(c.db.table(14).fetch([[[d[4],d[3]]]]),function(a){return c.i64.eq(a.threadKey,d[4])&&c.i64.eq([0,0],[0,0])&&c.i64.eq(a.contactId,d[3])}).next().then(function(b,c){var a=b.done;b=b.value;return a?d[40]=f:(c=b.item,d[40]=c.nickname)})},function(a){return c.ftr(c.db.table(7).fetch([[[d[3]]]]),function(a){return c.i64.eq(a.id,d[3])&&c.i64.eq([0,1],[0,1])}).next().then(function(b,e){var a=b.done;b=b.value;return a?(d[44]=c.localizeV2([0,14617150],f),d[42]=d[44]):(e=b.item,d[42]=e.firstName==null?e.name:e.firstName)})},function(a){return d[37]=d[40]==null?d[42]:d[40]}])},function(a){return d[38]=c.createArray(),d[40]=(d[38].push(d[37]),d[38]),d[39]=c.localizeV2([0,284944921],d[38]),d[36]=d[39]}])},function(a){return d[34]=d[36]}]):c.seq([function(a){return c.i64.eq(d[22],[0,2e3])?c.seq([function(a){return c.sp(b("LSGetViewerFBID")).then(function(a){return a=a,d[36]=a[0],a})},function(a){return c.i64.eq(d[36],d[3])?c.resolve((d[38]=c.localizeV2([0,3948960063],f),d[37]=d[38])):c.seq([function(a){return c.seq([function(a){return c.ftr(c.db.table(14).fetch([[[d[4],d[3]]]]),function(a){return c.i64.eq(a.threadKey,d[4])&&c.i64.eq([0,0],[0,0])&&c.i64.eq(a.contactId,d[3])}).next().then(function(b,c){var a=b.done;b=b.value;return a?d[41]=f:(c=b.item,d[41]=c.nickname)})},function(a){return c.ftr(c.db.table(7).fetch([[[d[3]]]]),function(a){return c.i64.eq(a.id,d[3])&&c.i64.eq([0,1],[0,1])}).next().then(function(b,e){var a=b.done;b=b.value;return a?(d[45]=c.localizeV2([0,14617150],f),d[43]=d[45]):(e=b.item,d[43]=e.firstName==null?e.name:e.firstName)})},function(a){return d[38]=d[41]==null?d[43]:d[41]}])},function(a){return d[39]=c.createArray(),d[41]=(d[39].push(d[38]),d[39]),d[40]=c.localizeV2([0,1249692047],d[39]),d[37]=d[40]}])},function(a){return d[35]=d[37]}]):c.seq([function(a){return c.i64.eq(d[22],[0,2001])?c.seq([function(a){return c.sp(b("LSGetViewerFBID")).then(function(a){return a=a,d[37]=a[0],a})},function(a){return c.i64.eq(d[37],d[3])?c.resolve((d[39]=c.localizeV2([0,2285746939],f),d[38]=d[39])):c.seq([function(a){return c.seq([function(a){return c.ftr(c.db.table(14).fetch([[[d[4],d[3]]]]),function(a){return c.i64.eq(a.threadKey,d[4])&&c.i64.eq([0,0],[0,0])&&c.i64.eq(a.contactId,d[3])}).next().then(function(b,c){var a=b.done;b=b.value;return a?d[42]=f:(c=b.item,d[42]=c.nickname)})},function(a){return c.ftr(c.db.table(7).fetch([[[d[3]]]]),function(a){return c.i64.eq(a.id,d[3])&&c.i64.eq([0,1],[0,1])}).next().then(function(b,e){var a=b.done;b=b.value;return a?(d[46]=c.localizeV2([0,14617150],f),d[44]=d[46]):(e=b.item,d[44]=e.firstName==null?e.name:e.firstName)})},function(a){return d[39]=d[42]==null?d[44]:d[42]}])},function(a){return d[40]=c.createArray(),d[42]=(d[40].push(d[39]),d[40]),d[41]=c.localizeV2([0,3759448420],d[40]),d[38]=d[41]}])},function(a){return d[36]=d[38]}]):c.seq([function(a){return c.i64.eq(d[22],[0,2002])?c.seq([function(a){return c.sp(b("LSGetViewerFBID")).then(function(a){return a=a,d[38]=a[0],a})},function(a){return c.i64.eq(d[38],d[3])?c.resolve((d[40]=c.localizeV2([0,3719716921],f),d[39]=d[40])):c.seq([function(a){return c.seq([function(a){return c.ftr(c.db.table(14).fetch([[[d[4],d[3]]]]),function(a){return c.i64.eq(a.threadKey,d[4])&&c.i64.eq([0,0],[0,0])&&c.i64.eq(a.contactId,d[3])}).next().then(function(b,c){var a=b.done;b=b.value;return a?d[43]=f:(c=b.item,d[43]=c.nickname)})},function(a){return c.ftr(c.db.table(7).fetch([[[d[3]]]]),function(a){return c.i64.eq(a.id,d[3])&&c.i64.eq([0,1],[0,1])}).next().then(function(b,e){var a=b.done;b=b.value;return a?(d[47]=c.localizeV2([0,14617150],f),d[45]=d[47]):(e=b.item,d[45]=e.firstName==null?e.name:e.firstName)})},function(a){return d[40]=d[43]==null?d[45]:d[43]}])},function(a){return d[41]=c.createArray(),d[43]=(d[41].push(d[40]),d[41]),d[42]=c.localizeV2([0,284944921],d[41]),d[39]=d[42]}])},function(a){return d[37]=d[39]}]):c.seq([function(a){return c.i64.eq(d[22],[0,2003])?c.seq([function(a){return c.sp(b("LSGetViewerFBID")).then(function(a){return a=a,d[39]=a[0],a})},function(a){return c.i64.eq(d[39],d[3])?c.resolve((d[41]=c.localizeV2([0,3948960063],f),d[40]=d[41])):c.seq([function(a){return c.seq([function(a){return c.ftr(c.db.table(14).fetch([[[d[4],d[3]]]]),function(a){return c.i64.eq(a.threadKey,d[4])&&c.i64.eq([0,0],[0,0])&&c.i64.eq(a.contactId,d[3])}).next().then(function(b,c){var a=b.done;b=b.value;return a?d[44]=f:(c=b.item,d[44]=c.nickname)})},function(a){return c.ftr(c.db.table(7).fetch([[[d[3]]]]),function(a){return c.i64.eq(a.id,d[3])&&c.i64.eq([0,1],[0,1])}).next().then(function(b,e){var a=b.done;b=b.value;return a?(d[48]=c.localizeV2([0,14617150],f),d[46]=d[48]):(e=b.item,d[46]=e.firstName==null?e.name:e.firstName)})},function(a){return d[41]=d[44]==null?d[46]:d[44]}])},function(a){return d[42]=c.createArray(),d[44]=(d[42].push(d[41]),d[42]),d[43]=c.localizeV2([0,1249692047],d[42]),d[40]=d[43]}])},function(a){return d[38]=d[40]}]):c.seq([function(a){return c.i64.eq(d[22],[0,3e3])?c.seq([function(a){return c.sp(b("LSGetViewerFBID")).then(function(a){return a=a,d[40]=a[0],a})},function(a){return c.i64.eq(d[40],d[3])?c.resolve((d[42]=c.localizeV2([0,2135145355],f),d[41]=d[42])):c.seq([function(a){return c.seq([function(a){return c.ftr(c.db.table(14).fetch([[[d[4],d[3]]]]),function(a){return c.i64.eq(a.threadKey,d[4])&&c.i64.eq([0,0],[0,0])&&c.i64.eq(a.contactId,d[3])}).next().then(function(b,c){var a=b.done;b=b.value;return a?d[45]=f:(c=b.item,d[45]=c.nickname)})},function(a){return c.ftr(c.db.table(7).fetch([[[d[3]]]]),function(a){return c.i64.eq(a.id,d[3])&&c.i64.eq([0,1],[0,1])}).next().then(function(b,e){var a=b.done;b=b.value;return a?(d[49]=c.localizeV2([0,14617150],f),d[47]=d[49]):(e=b.item,d[47]=e.firstName==null?e.name:e.firstName)})},function(a){return d[42]=d[45]==null?d[47]:d[45]}])},function(a){return d[43]=c.createArray(),d[45]=(d[43].push(d[42]),d[43]),d[44]=c.localizeV2([0,3603511704],d[43]),d[41]=d[44]}])},function(a){return d[39]=d[41]}]):c.resolve(d[39]=f)},function(a){return d[38]=d[39]}])},function(a){return d[37]=d[38]}])},function(a){return d[36]=d[37]}])},function(a){return d[35]=d[36]}])},function(a){return d[34]=d[35]}])},function(a){return d[33]=d[34]}])},function(a){return d[32]=d[33]}])},function(a){return d[31]=d[32]}])},function(a){return d[30]=d[31]}])},function(a){return d[29]=d[30]}])},function(a){return d[28]=d[29]}])},function(a){return d[27]=d[28]}])},function(a){return d[26]=d[27]}])},function(a){return d[23]=d[26]}]):c.resolve(d[23]=f)},function(a){return d[21]===f&&c.i64.eq(d[16],[0,7])&&d[23]!==f?d[21]=d[23]:0,c.sp(b("LSGetViewerFBID")).then(function(a){return a=a,d[24]=a[0],a})},function(a){return c.i64.eq(d[24],d[3])?c.resolve((d[26]=c.localizeV2([0,3948960063],f),d[25]=d[26])):c.seq([function(a){return c.seq([function(a){return c.ftr(c.db.table(14).fetch([[[d[4],d[3]]]]),function(a){return c.i64.eq(a.threadKey,d[4])&&c.i64.eq([0,0],[0,0])&&c.i64.eq(a.contactId,d[3])}).next().then(function(b,c){var a=b.done;b=b.value;return a?d[29]=f:(c=b.item,d[29]=c.nickname)})},function(a){return c.ftr(c.db.table(7).fetch([[[d[3]]]]),function(a){return c.i64.eq(a.id,d[3])&&c.i64.eq([0,1],[0,1])}).next().then(function(b,e){var a=b.done;b=b.value;return a?(d[33]=c.localizeV2([0,14617150],f),d[31]=d[33]):(e=b.item,d[31]=e.firstName==null?e.name:e.firstName)})},function(a){return d[26]=d[29]==null?d[31]:d[29]}])},function(a){return d[27]=c.createArray(),d[29]=(d[27].push(d[26]),d[27]),d[28]=c.localizeV2([0,1249692047],d[27]),d[25]=d[28]}])},function(a){return d[15]=d[21]==null?d[25]:d[21]}]):c.seq([function(a){return d[16]=!0,c.fe(c.ftr(c.db.table(16).fetch([[[d[4],d[8]]]]),function(a){return c.i64.eq(a.threadKey,d[4])&&c.i64.eq([0,0],d[7])&&a.messageId===d[8]}),function(a){a=a.item;return c.i64.eq(a.attachmentType,[0,2])?0:d[16]=!1})},function(a){return d[16]?c.seq([function(a){return c.sp(b("LSGetViewerFBID")).then(function(a){return a=a,d[18]=a[0],a})},function(a){return c.i64.eq(d[18],d[3])?c.resolve((d[20]=c.createArray(),d[22]=(d[20].push(d[13]),d[20]),d[21]=c.localizeV2([0,705614308],d[20]),d[19]=d[21])):c.seq([function(a){return c.seq([function(a){return c.ftr(c.db.table(14).fetch([[[d[4],d[3]]]]),function(a){return c.i64.eq(a.threadKey,d[4])&&c.i64.eq([0,0],[0,0])&&c.i64.eq(a.contactId,d[3])}).next().then(function(b,c){var a=b.done;b=b.value;return a?d[23]=f:(c=b.item,d[23]=c.nickname)})},function(a){return c.ftr(c.db.table(7).fetch([[[d[3]]]]),function(a){return c.i64.eq(a.id,d[3])&&c.i64.eq([0,1],[0,1])}).next().then(function(b,e){var a=b.done;b=b.value;return a?(d[27]=c.localizeV2([0,14617150],f),d[25]=d[27]):(e=b.item,d[25]=e.firstName==null?e.name:e.firstName)})},function(a){return d[20]=d[23]==null?d[25]:d[23]}])},function(a){return d[21]=c.createArray(),d[23]=(d[21].push(d[20]),d[21]),d[23]=(d[21].push(d[13]),d[21]),d[22]=c.localizeV2([0,313217698],d[21]),d[19]=d[22]}])},function(a){return d[17]=d[19]}]):c.seq([function(a){return c.sp(b("LSGetViewerFBID")).then(function(a){return a=a,d[18]=a[0],a})},function(a){return c.i64.eq(d[18],d[3])?c.resolve((d[20]=c.localizeV2([0,3558654267],f),d[19]=d[20])):c.seq([function(a){return c.seq([function(a){return c.ftr(c.db.table(14).fetch([[[d[4],d[3]]]]),function(a){return c.i64.eq(a.threadKey,d[4])&&c.i64.eq([0,0],[0,0])&&c.i64.eq(a.contactId,d[3])}).next().then(function(b,c){var a=b.done;b=b.value;return a?d[23]=f:(c=b.item,d[23]=c.nickname)})},function(a){return c.ftr(c.db.table(7).fetch([[[d[3]]]]),function(a){return c.i64.eq(a.id,d[3])&&c.i64.eq([0,1],[0,1])}).next().then(function(b,e){var a=b.done;b=b.value;return a?(d[27]=c.localizeV2([0,14617150],f),d[25]=d[27]):(e=b.item,d[25]=e.firstName==null?e.name:e.firstName)})},function(a){return d[20]=d[23]==null?d[25]:d[23]}])},function(a){return d[21]=c.createArray(),d[23]=(d[21].push(d[20]),d[21]),d[22]=c.localizeV2([0,3422266740],d[21]),d[19]=d[22]}])},function(a){return d[17]=d[19]}])},function(a){return d[15]=d[17]}])},function(a){return d[14]=d[15]}])},function(a){return d[12]=d[14]}])},function(a){return d[11]=d[12]}])},function(a){return d[10]=d[11]}])},function(a){return d[9]=d[10]}])},function(a){return d[1]=d[9]}])},function(e){return c.sp(b("LSUpdateThreadSnippet"),a[0],d[1],d[2],d[3],c.like(d[1],"%\udb80\udc00%"),f,f,!1)}]))})},function(a){return c.resolve(e)}])}e.exports=a}),null);